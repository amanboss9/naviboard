!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.naviBoard=e():t.naviBoard=e()}(window,(function(){return function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){var r=i(1);t.exports=r},function(t,e){function i(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return r(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return r(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}var n=window;function a(){this.currentEvent=null,this.componentRendered=null,this.matrixForNavigation=null,this.currentX=0,this.currentY=0,this.activeElement=null,this.prevComponentRendered=[],this.prevActiveElement=[],this.nextComponentRendered=null,this.arrayOfCoordinates=[],this.initialOffsetX=0,this.initialOffsetY=0,this.resume=!0,this.matrixWidth=0,this.matrixHeight=0}a.prototype._getLocationOfActiveElement=function(t){if(null!=this.matrixForNavigation)for(var e=0;e<this.matrixForNavigation.length;e++)for(var i=0;i<this.matrixForNavigation[0].length;i++)if(this.matrixForNavigation[e][i]===t)return[e,i];return[0,0]},a.prototype.makeNavigationRulesForComponent=function(t,e,r){var n=this,a=this,o=JSON.parse(JSON.stringify(function t(e){var i=new Array(e||0),r=e;if(arguments.length>1)for(var n=Array.prototype.slice.call(arguments,1);r--;)i[e-1-r]=t.apply(this,n);return i}(e,r)));new Promise((function(a,s){var h=n.matrixWidth/r,u=n.matrixHeight/e;a(function(t,e,i,r){var n=Array.from(Object.create(e)),a=t;function o(t,e,i,r,n,a){for(var o=0;o<a;o++)for(var s=0;s<n;s++)t[i+o][r+s]=e}if(void 0!==a&&a!==[])for(var s=0;s<a.length;s++)for(var h=0;h<a[s].length;h++){var u=void 0,c=void 0;null!=a[s][h]&&(u=Math.round(a[s][h].offset.width/i),c=Math.round(a[s][h].offset.height/r)),null!==a[s][h]&&(u>1||c>1)?o(n,a[s][h].elementToFocus,s,h,u,c):null!==a[s][h]&&(n[s][h]=a[s][h].elementToFocus)}return n}(function(t){for(var e=0;e<t.length;e++)t[e].iValue=t.length*t[e].offset.x+t[e].offset.y;t.sort((function(t,e){return t.offset.y<e.offset.y?-1:t.offset.y>e.offset.y?1:0}));for(var r=[],n=[],a=!1,o=0;o<t.length;o++)a?t[o].offset.y>n[n.length-1].offset.y&&o!==t.length-1?(r.push(n),(n=[]).push(t[o])):o===t.length-1?t[o].offset.y>n[n.length-1].offset.y?(r.push(n),(n=[]).push(t[o]),r.push(n)):(n.push(t[o]),r.push(n)):n.push(t[o]):(n.push(t[o]),a=!0);n.length>0&&0===r.length&&r.push(n);for(var s=0;s<r.length;s++)r[s].sort((function(t,e){return t.offset.x<e.offset.x?-1:t.offset.x>e.offset.x?1:0}));var h=i(new Set(r.reduce((function(t,e){return t.concat(e.map((function(t){return t.offset.x})))}),[]))).sort((function(t,e){return t-e}));return r.forEach((function(t){h.forEach((function(e,i){(void 0===t[i]||t[i].offset.x>e)&&t.splice(i,0,null)}))})),r}(t),o,h,u)),s("Error in getting matrix for navigation.")})).then((function(t){if(a.matrixForNavigation=t,null!=a.matrixForNavigation&&0!==a.matrixForNavigation.length){var e=!1;if(a.prevComponentRendered.length>=2&&a.prevActiveElement.length>=2&&a.prevComponentRendered[a.prevComponentRendered.length-2]===a.nextComponentRendered&&null!=a.prevComponentRendered[a.prevComponentRendered.length-2]&&null!=a.nextComponentRendered){var i=a.prevActiveElement[a.prevActiveElement.length-2];a.currentX=i[0],a.currentY=i[1],e=!0}if(a.matrixForNavigation.length<a.currentX&&a.matrixForNavigation[0].length<a.currentY){for(var r=0;r<a.matrixForNavigation[0].length;r++)if(null!=a.matrixForNavigation[0][r]){a.currentX=0,a.currentY=r,a.activeElement=a.matrixForNavigation[a.currentX][a.currentY],a.activeElement.focus();break}}else if(a.matrixForNavigation.length>a.currentX&&a.matrixForNavigation[0].length>a.currentY&&e)a.activeElement=a.matrixForNavigation[a.currentX][a.currentY],a.activeElement.focus();else if(a.matrixForNavigation.length>a.currentX&&a.matrixForNavigation[0].length>a.currentY){for(var n=0;n<a.matrixForNavigation[0].length;n++)if(null!=a.matrixForNavigation[0][n]){a.currentX=0,a.currentY=n,a.activeElement=a.matrixForNavigation[a.currentX][a.currentY],a.activeElement.focus();break}}else for(var o=0;o<a.matrixForNavigation[0].length;o++)if(null!=a.matrixForNavigation[0][o]){a.currentX=0,a.currentY=o,a.activeElement=a.matrixForNavigation[a.currentX][a.currentY],a.activeElement.focus();break}}}),(function(t){console.log(t)}))},a.prototype.destroyCurrentNavigationView=function(t,e){return"destroy"===e&&(this.prevComponentRendered.push(this.componentRendered),this.prevComponentRendered.length>=5&&(this.prevComponentRendered=this.prevComponentRendered.slice(Math.max(this.prevComponentRendered.length-5,2))),this.prevActiveElement.push(this._getLocationOfActiveElement(this.activeElement)),this.prevActiveElement.length>=5&&(this.prevActiveElement=this.prevActiveElement.slice(Math.max(this.prevActiveElement.length-5,2))),this.componentRendered=null),this.arrayOfCoordinates=[],o=[],s=[],this.initialOffsetX=0,this.initialOffsetY=0,this.matrixForNavigation=null,this.currentX=0,this.currentY=0,this.activeElement=null,this.currentEvent=null,!0};var o=[],s=[];function h(t){for(var e=t[0].offset.left,i=t[0].offset.right,r=t[0].offset.top,n=t[0].offset.bottom,a=1,o=t.length;a<o;a++){var s=t[a].offset.left,h=t[a].offset.top,u=t[a].offset.right,c=t[a].offset.bottom;e=s<e?s:e,r=h<r?h:r,i=u>i?u:i,n=c>n?c:n}return[i-e,n-r]}a.prototype.increaseRowCountIfRequired=function(t,e){return t.y=Math.round(t.y),t.y>this.initialOffsetY&&t.y>Math.max.apply(Math,i(s))||t.y<this.initialOffsetY&&!s.includes(t.y)?(this.initialOffsetY=t.y,s.push(t.y),e+1):e},a.prototype.increaseColumnCountIfRequired=function(t,e){return t.x=Math.round(t.x),t.x>this.initialOffsetX&&t.x>Math.max.apply(Math,i(o))||t.x<this.initialOffsetX&&!o.includes(t.x)?(this.initialOffsetX=t.x,o.push(t.x),e+1):e},a.prototype.handleView=function(t){var e=this;e.arrayOfCoordinates=[],e.componentRendered=t;new Promise((function(e,i){n=document.getElementById(t),e(n.getElementsByClassName("navigable")),i("Error in resolving child nodes!")})).then((function(t){for(var i=0,r=0,n=0;n<t.length;n++){t[n].tabIndex=-1===t[n].tabIndex?0:t[n].tabIndex;var a=t[n].getBoundingClientRect();i=e.increaseRowCountIfRequired(a,i),r=e.increaseColumnCountIfRequired(a,r),e.arrayOfCoordinates.push({offset:a,elementToFocus:t[n]})}e.matrixWidth=h(e.arrayOfCoordinates)[0],e.matrixHeight=h(e.arrayOfCoordinates)[1],e.makeNavigationRulesForComponent(e.arrayOfCoordinates,i,r)}),(function(t){console.log(t)}))};var u=new a;u.getActiveElement=function(){return this.activeElement},u.setNavigation=function(t){null===this.matrixForNavigation&&(this.nextComponentRendered=t,this.handleView(t))},u.destroyNavigation=function(t){this.destroyCurrentNavigationView(t,"destroy")},u.getCurrentEvent=function(t){return this.currentEvent},u.refreshNavigation=function(t,e){if("refresh"===e){this.prevComponentRendered.push(this.componentRendered),this.prevActiveElement.push(this._getLocationOfActiveElement(this.activeElement)),this.destroyCurrentNavigationView(t,"destroy")&&this.handleView(t)}else{this.destroyCurrentNavigationView(t,e)&&this.handleView(t)}},u.getNavigationComponent=function(){return this.componentRendered},u.resumeNavigation=function(){this.resume=!0},u.pauseNavigation=function(){this.resume=!1};var c=function(t){if(null!==this.matrixForNavigation&&this.resume){var e=this.matrixForNavigation.length,i=this.matrixForNavigation[0].length,r=function(){for(var t=arguments[1];t>=0;){if(void 0!==this.matrixForNavigation[arguments[0]][t]&&null!==this.matrixForNavigation[arguments[0]][t])return this.activeElement.blur(),this.currentX=arguments[0],this.currentY=t,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus(),!0;t--}return!1}.bind(this),n=function(){for(var t=arguments[1];t<i;){if(void 0!==this.matrixForNavigation[arguments[0]][t]&&null!==this.matrixForNavigation[arguments[0]][t])return this.activeElement.blur(),this.currentX=arguments[0],this.currentY=t,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus(),!0;t++}return!1}.bind(this),a=function(){for(var t=arguments[0];t>=0;){if(void 0!==this.matrixForNavigation[t][arguments[1]]&&null!==this.matrixForNavigation[t][arguments[1]])return this.activeElement.blur(),this.currentY=arguments[1],this.currentX=t,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus(),!0;t--}return!1}.bind(this),o=function(){for(var t=arguments[0];t<e;){if(void 0!==this.matrixForNavigation[t][arguments[1]]&&null!==this.matrixForNavigation[t][arguments[1]])return this.activeElement.blur(),this.currentY=arguments[1],this.currentX=t,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus(),!0;t++}return!1}.bind(this);if(null!=this.matrixForNavigation&&0!=this.matrixForNavigation.length)if(this.currentEvent=t,40==t.keyCode){if(this.currentX+1>=e);else if(null!=this.matrixForNavigation[this.currentX+1][this.currentY]&&this.matrixForNavigation[this.currentX+1][this.currentY]!=this.activeElement)this.activeElement.blur(),this.currentX=this.currentX+1,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus();else if(void 0!==this.matrixForNavigation[this.currentX+1][this.currentY]&&this.matrixForNavigation[this.currentX+1][this.currentY]!=this.activeElement&&null===this.matrixForNavigation[this.currentX+1][this.currentY]){for(var s=this.currentX+1,h=!1;s<e;){if(null!=this.matrixForNavigation[s][this.currentY]){this.activeElement.blur(),this.currentX=s,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus(),h=!0;break}s++}if(this.currentY>=0&&!h)0==r(this.currentX+1,this.currentY)&&n(this.currentX+1,this.currentY)}else if(this.matrixForNavigation[this.currentX+1][this.currentY]===this.activeElement)for(s=this.currentX+1;s<e;){if(this.matrixForNavigation[s][this.currentY]!=this.activeElement){this.activeElement.blur(),this.currentX=s,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus();break}s++}}else if(38==t.keyCode){if(this.currentX-1<0);else if(null!=this.matrixForNavigation[this.currentX-1][this.currentY]&&this.matrixForNavigation[this.currentX-1][this.currentY]!=this.activeElement)this.activeElement.blur(),this.currentX=this.currentX-1,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus();else if(void 0!==this.matrixForNavigation[this.currentX-1][this.currentY]&&this.matrixForNavigation[this.currentX-1][this.currentY]!=this.activeElement&&null===this.matrixForNavigation[this.currentX-1][this.currentY]){var u=this.currentX-1;for(h=!1;u>=0;){if(null!=this.matrixForNavigation[u][this.currentY]){this.activeElement.blur(),this.currentX=u,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus(),h=!0;break}u--}if(this.currentY>0&&!h)0==r(this.currentX-1,this.currentY)&&n(this.currentX-1,this.currentY)}else if(this.matrixForNavigation[this.currentX-1][this.currentY]===this.activeElement)for(u=this.currentX-1;u>=0;){if(this.matrixForNavigation[u][this.currentY]!=this.activeElement){this.activeElement.blur(),this.currentX=u,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus();break}u--}}else if(39==t.keyCode){if(this.currentY+1>=i);else if(null!=this.matrixForNavigation[this.currentX][this.currentY+1]&&this.matrixForNavigation[this.currentX][this.currentY+1]!=this.activeElement)this.activeElement.blur(),this.currentY=this.currentY+1,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus();else if(void 0!==this.matrixForNavigation[this.currentX][this.currentY+1]&&this.matrixForNavigation[this.currentX][this.currentY+1]!=this.activeElement&&null===this.matrixForNavigation[this.currentX][this.currentY+1]){h=!1;for(var c=this.currentY+1;c<i;){if(null!=this.matrixForNavigation[this.currentX][c]){this.activeElement.blur(),this.currentY=c,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus(),h=!0;break}c++}if(this.currentY>0&&!h)0==a(this.currentX,this.currentY+1)&&o(this.currentX,this.currentY+1)}else if(this.matrixForNavigation[this.currentX][this.currentY+1]===this.activeElement)for(c=this.currentY+1;c<i;){if(this.matrixForNavigation[this.currentX][c]!=this.activeElement){this.activeElement.blur(),this.currentY=c,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus();break}c++}}else if(37==t.keyCode)if(this.currentY-1<0);else if(null!=this.matrixForNavigation[this.currentX][this.currentY-1]&&this.matrixForNavigation[this.currentX][this.currentY-1]!=this.activeElement)this.activeElement.blur(),this.currentY=this.currentY-1,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus();else if(void 0!==this.matrixForNavigation[this.currentX][this.currentY-1]&&this.matrixForNavigation[this.currentX][this.currentY-1]!=this.activeElement&&null===this.matrixForNavigation[this.currentX][this.currentY-1]){var l=this.currentY-1;for(h=!1;l>=0;){if(null!=this.matrixForNavigation[this.currentX][l]){this.activeElement.blur(),this.currentY=l,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus(),h=!0;break}l--}if(this.currentX>0&&!h)0==a(this.currentX,this.currentY-1)&&o(this.currentX,this.currentY-1)}else if(this.matrixForNavigation[this.currentX][this.currentY-1]===this.activeElement)for(l=this.currentY-1;l>=0;){if(this.matrixForNavigation[this.currentX][l]!=this.activeElement){this.activeElement.blur(),this.currentY=l,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus();break}l--}}else console.log("Navigation is paused")}.bind(u);n.addEventListener("keydown",c,!0),t.exports=u}])}));