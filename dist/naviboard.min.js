!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.naviBoard=e():t.naviBoard=e()}(window,function(){return function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([function(t,e,i){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}var n=window;function o(){this.currentEvent=null,this.componentRendered=null,this.matrixForNavigation=null,this.currentX=0,this.currentY=0,this.activeElement=null,this.prevComponentRendered=[],this.prevActiveElement=[],this.nextComponentRendered=null,this.arrayOfCoordinates=[],this.initialOffsetX=0,this.initialOffsetY=0,this.resume=!0}o.prototype._getLocationOfActiveElement=function(t){if(null!=this.matrixForNavigation)for(var e=0;e<this.matrixForNavigation.length;e++)for(var i=0;i<this.matrixForNavigation[0].length;i++)if(this.matrixForNavigation[e][i]==t)return[e,i];return[0,0]},o.prototype.getWindowRelativeOffset=function(t){return t.getBoundingClientRect()},o.prototype.makeNavigationRulesForComponent=function(t,e,i){var r=this,n=JSON.parse(JSON.stringify(function t(e){var i=new Array(e||0),r=e;if(arguments.length>1)for(var n=Array.prototype.slice.call(arguments,1);r--;)i[e-1-r]=t.apply(this,n);return i}(e,i)));new Promise(function(e,i){e(function(t,e){var i=Array.from(Object.create(e)),r=t;if(void 0!=r&&r!=[])for(var n=0;n<r.length;n++)for(var o=0;o<r[n].length;o++)i[n][o]=r[n][o].elementToFocus;return i}(function(t){for(var e=0;e<t.length;e++){var i=t.length*t[e].offset.x+t[e].offset.y;t[e].iValue=i}t.sort(function(t,e){var i=t.offset.y,r=e.offset.y;return i<r?-1:i>r?1:0});var r=[],n=[],o=!1;for(e=0;e<t.length;e++)o?t[e].offset.y>n[n.length-1].offset.y&&e!=t.length-1?(r.push(n),(n=[]).push(t[e])):e===t.length-1?t[e].offset.y>n[n.length-1].offset.y?(r.push(n),(n=[]).push(t[e]),r.push(n)):(n.push(t[e]),r.push(n)):n.push(t[e]):(n.push(t[e]),o=!0);n.length>0&&0==r.length&&r.push(n);for(var s=0;s<r.length;s++)r[s].sort(function(t,e){var i=t.offset.x,r=e.offset.x;return i<r?-1:i>r?1:0});return r}(t),n)),i(err)}).then(function(t){if(r.matrixForNavigation=t,0!=r.matrixForNavigation.length&&void 0!=r.matrixForNavigation){if(r.prevComponentRendered.length>=2&&r.prevActiveElement.length>=2&&r.prevComponentRendered[r.prevComponentRendered.length-2]==r.nextComponentRendered&&null!=r.prevComponentRendered[r.prevComponentRendered.length-2]&&null!=r.nextComponentRendered){var e=r.prevActiveElement[r.prevActiveElement.length-2];r.currentX=e[0],r.currentY=e[1]}r.matrixForNavigation.length<r.currentX&&r.matrixForNavigation[0].length<r.currentY?(r.activeElement=r.matrixForNavigation[r.currentX][r.currentY],r.activeElement.focus()):r.matrixForNavigation.length>r.currentX&&r.matrixForNavigation[0].length>r.currentY?(r.activeElement=r.matrixForNavigation[r.currentX][r.currentY],r.activeElement.focus()):(r.currentX=0,r.currentY=0,r.activeElement=r.matrixForNavigation[r.currentX][r.currentY],r.activeElement.focus())}},function(t){console.log(t)})};var s=(new Date).getTime();o.prototype.destroyCurrentNavigationView=function(t,e){var i=(new Date).getTime();return i-s<250?(s=i,!1):"destroy"==e?(this.prevComponentRendered.push(this.componentRendered),this.prevComponentRendered.length>=5&&(this.prevComponentRendered=this.prevComponentRendered.slice(Math.max(this.prevComponentRendered.length-5,2))),this.prevActiveElement.push(this._getLocationOfActiveElement(this.activeElement)),this.prevActiveElement.length>=5&&(this.prevActiveElement=this.prevActiveElement.slice(Math.max(this.prevActiveElement.length-5,2))),this.arrayOfCoordinates=[],a=[],u=[],this.initialOffsetX=0,this.initialOffsetY=0,this.matrixForNavigation=null,this.currentX=0,this.currentY=0,this.activeElement=null,this.currentEvent=null,this.componentRendered=null,s=i,!0):(a=[],u=[],this.arrayOfCoordinates=[],this.initialOffsetX=0,this.initialOffsetY=0,this.matrixForNavigation=null,this.currentX=0,this.currentY=0,this.activeElement=null,this.currentEvent=null,s=i,!0)};var a=[],u=[];o.prototype.increaseRowCountIfRequired=function(t,e){return t.y>this.initialOffsetY&&t.y>Math.max.apply(Math,r(u))?(this.initialOffsetY=t.y,u.push(t.y),e+1):t.y<this.initialOffsetY&&!u.includes(t.y)?(this.initialOffsetY=t.y,u.push(t.y),e+1):e},o.prototype.increaseColumnCountIfRequired=function(t,e){return t.x>this.initialOffsetX&&t.x>Math.max.apply(Math,r(a))?(this.initialOffsetX=t.x,a.push(t.x),e+1):t.x<this.initialOffsetX&&!a.includes(t.x)?(this.initialOffsetX=t.x,a.push(t.x),e+1):e},o.prototype.handleView=function(t){var e=this;e.arrayOfCoordinates=[],e.componentRendered=t;new Promise(function(e,i){n=document.getElementById(t),e(n.getElementsByClassName("navigable")),i(err)}).then(function(t){for(var i=0,r=0,n=0;n<t.length;n++){var o=e.getWindowRelativeOffset(t[n]);i=e.increaseRowCountIfRequired(o,i),r=e.increaseColumnCountIfRequired(o,r);var s={offset:o,elementToFocus:t[n]};e.arrayOfCoordinates.push(s)}e.makeNavigationRulesForComponent(e.arrayOfCoordinates,i,r)},function(t){console.log(t)})};var h=new o;h.getActiveElement=function(){return this.activeElement},h.setNavigation=function(t){null===this.matrixForNavigation&&(this.nextComponentRendered=t,this.handleView(t))},h.destroyNavigation=function(t){this.destroyCurrentNavigationView(t,"destroy")},h.getCurrentEvent=function(t){return this.currentEvent},h.refreshNavigation=function(t,e){if("refresh"==e){this.prevComponentRendered.push(this.componentRendered),this.prevActiveElement.push(this._getLocationOfActiveElement(activeElement)),this.destroyCurrentNavigationView(t,"destroy")&&this.handleView(t)}else{this.destroyCurrentNavigationView(t,e)&&this.handleView(t)}},h.getNavigationComponent=function(){return this.componentRendered},h.resumeNavigation=function(){this.resume=!0},h.pauseNavigation=function(){this.resume=!1};var c=function(t){if(null!==this.matrixForNavigation&&this.resume){var e=this.matrixForNavigation.length,i=this.matrixForNavigation[0].length,r=function(){for(var t=arguments[1];t>=0;){if(void 0!==this.matrixForNavigation[arguments[0]][t]&&null!==this.matrixForNavigation[arguments[0]][t])return this.activeElement.blur(),this.currentX=arguments[0],this.currentY=t,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus(),!0;t--}return!1}.bind(this),n=function(){for(var t=arguments[1];t<i;){if(void 0!==this.matrixForNavigation[arguments[0]][t]&&null!==this.matrixForNavigation[arguments[0]][t])return this.activeElement.blur(),this.currentX=arguments[0],this.currentY=t,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus(),!0;t++}return!1}.bind(this),o=function(){for(var t=arguments[0];t>=0;){if(void 0!==this.matrixForNavigation[t][arguments[1]]&&null!==this.matrixForNavigation[t][arguments[1]])return this.activeElement.blur(),this.currentY=arguments[1],this.currentX=t,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus(),!0;t--}return!1}.bind(this),s=function(){for(var t=arguments[0];t<e;){if(void 0!==this.matrixForNavigation[t][arguments[1]]&&null!==this.matrixForNavigation[t][arguments[1]])return this.activeElement.blur(),this.currentY=arguments[1],this.currentX=t,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus(),!0;t++}return!1}.bind(this);if(null!=this.matrixForNavigation&&0!=this.matrixForNavigation.length)if(this.currentEvent=t,40==t.keyCode){if(this.currentX+1>=e);else if(void 0!=this.matrixForNavigation[this.currentX+1][this.currentY])this.activeElement.blur(),this.currentX=this.currentX+1,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus();else if(void 0!==this.matrixForNavigation[this.currentX+1][this.currentY]&&null===this.matrixForNavigation[this.currentX+1][this.currentY]){if(this.currentY>0)0==r(this.currentX+1,this.currentY)&&n(this.currentX+1,this.currentY)}}else if(38==t.keyCode){if(this.currentX-1<0);else if(void 0!=this.matrixForNavigation[this.currentX-1][this.currentY])this.activeElement.blur(),this.currentX=this.currentX-1,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus();else if(void 0!==this.matrixForNavigation[this.currentX-1][this.currentY]&&null===this.matrixForNavigation[this.currentX-1][this.currentY]){if(this.currentY>0)0==r(this.currentX-1,this.currentY)&&n(this.currentX-1,this.currentY)}}else if(39==t.keyCode){if(this.currentY+1>=i);else if(void 0!=this.matrixForNavigation[this.currentX][this.currentY+1])this.activeElement.blur(),this.currentY=this.currentY+1,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus();else if(void 0!==this.matrixForNavigation[this.currentX][this.currentY+1]&&null===this.matrixForNavigation[this.currentX][this.currentY+1]){if(this.currentY>0)0==o(this.currentX,this.currentY+1)&&s(this.currentX,this.currentY+1)}}else if(37==t.keyCode)if(this.currentY-1<0);else if(void 0!=this.matrixForNavigation[this.currentX][this.currentY-1])this.activeElement.blur(),this.currentY=this.currentY-1,this.activeElement=this.matrixForNavigation[this.currentX][this.currentY],this.activeElement.focus();else if(void 0!==this.matrixForNavigation[this.currentX][this.currentY-1]&&null===this.matrixForNavigation[this.currentX][this.currentY-1]){if(this.currentX>0)0==o(this.currentX,this.currentY-1)&&s(this.currentX,this.currentY-1)}}else console.log("Navigation is paused")}.bind(h);n.addEventListener("keydown",c,!0),t.exports=h},function(t,e,i){"use strict";var r=i(0);t.exports=r}])});